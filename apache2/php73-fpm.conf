<VirtualHost *:80>
  ServerName %%fqdn%%
  DocumentRoot "%%document_root%%"
  AssignUserId #%%UID%% #%%GID%%
  SetEnv LOGIN "%%UID%%-%%LOGIN%%"
  SetEnvIf Authorization "(.*)" HTTP_AUTHORIZATION=$1
    
  # Custom extentions
  <FilesMatch ^.*(log|sql|sqlite|bak|swp|php~)$>
        Order allow,deny
        Deny from all 
  </FilesMatch>

  # Common folders to deny
  <DirectoryMatch .*\.(svn|git|ssh)/.*>
        Order allow,deny
        Deny from all 
  </DirectoryMatch>

  # Common files or folder names begin by
  <FilesMatch .*\.(user.ini|php.ini|ssh|env|hg|gitignore|bashrc|bash_history|zsh_history|mysql_history|ht)$>
        Order allow,deny
        Deny from all 
  </FilesMatch>
  <FilesMatch (user.ini|php.ini)$>
        Order allow,deny
        Deny from all 
  </FilesMatch>

  <FilesMatch \.php$>
        SetHandler "proxy:unix:/run/php/php7.3-%%LOGIN%%.sock|fcgi://localhost"
  </FilesMatch>

  RewriteEngine on
  RewriteCond %{QUERY_STRING} (%2d|-)d.*auto_prepend  [NC]
  RewriteRule .? - [F,L]

  <Directory "%%document_root%%">
    require all granted
    php_admin_value open_basedir "%%document_root%%:/usr/share/php/:/var/alternc/tmp:/tmp"
    Options +MultiViews -FollowSymLinks +SymLinksIfOwnerMatch
    AllowOverride AuthConfig FileInfo Limit Options Indexes
    php_admin_flag engine off
  </Directory>
</VirtualHost>

